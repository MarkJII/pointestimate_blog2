)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('ERA Dif')+
xlab('AVG Dif')+
ylim(-1.05,1.05)+
xlim(-0.05,0.05)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_trad_table
ws_trad_stats <- world_series_team_stats %>%
mutate(adv_type = case_when(avg_dif >= 0 & era_dif <= 0 ~ 'Better Pitching and Hitting',
avg_dif < 0 & era_dif <= 0 ~ 'Better Pitching, Worse Hitting',
avg_dif < 0 & era_dif > 0 ~ 'Worse Pitching and Hitting',
avg_dif >= 0 & era_dif > 0 ~ 'Worse Pitching, Better Hitting'))
ws_trad_table <- ws_trad_stats %>%
group_by(better_avg, better_era) %>%
summarise(teams = n()) %>%
pivot_wider(names_from = better_era, values_from = teams) %>%
ungroup() %>%
mutate(Total = `Better ERA` + `Worse ERA`) %>%
gt() %>%
grand_summary_rows(columns = c(2:4),
formatter = fmt_integer,
fns = list(Total = ~sum(.))) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
better_avg = "",
)
ws_trad_scatter <- ws_trad_stats %>%
ggplot(aes(x = avg_dif,
y = era_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>AVG:',
round(AVG_winner, 3),
'<br>','ERA: ', round(ERA_winner, 3),
'<br><br><b>',name_loser, '</b></br>ERA:',
round(AVG_loser, 3),
'<br>', 'ERA: ',
round(ERA_loser, 3),
'<br><br>', 'AVG Dif: ',
round(avg_dif, 3),
'<br>', 'ERA Dif: ',
round(era_dif, 3)
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('ERA Dif')+
xlab('AVG Dif')+
ylim(-1.05,1.05)+
xlim(-0.05,0.05)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_trad_table
ggplotly(ws_trad_scatter, tooltip = "text") %>%
layout(legend=list(title=list(text='<b>Winner Type</b>')))
ws_saber_table <- ws_saber_stats %>%
group_by(better_wrc_plus, better_fip_minus) %>%
summarise(teams = n()) %>%
pivot_wider(names_from = better_fip_minus, values_from = teams) %>%
ungroup() %>%
mutate(Total = `Better FIP-` + `Worse FIP-`) %>%
gt() %>%
grand_summary_rows(columns = c(2:4),
formatter = fmt_integer,
fns = list(Total = ~sum(.))) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
better_wrc_plus = "",
)
ws_saber_table
ws_saber_stats %>%
ggplot(aes(x = wrc_plus_dif,
y = fip_minus_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>wRC+:',
wRC._winner,
'<br>','FIP-: ', FIP_winner,
'<br><br><b>',name_loser, '</b></br>wRC+:',
wRC._loser,
'<br>', 'FIP-: ',
FIP_loser,
'<br><br>', 'wRC+ Dif: ',
wrc_plus_dif,
'<br>', 'FIP- Dif: ',
fip_minus_dif
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('FIP- Dif')+
xlab('wRC+ Dif')+
#ylim(-1.05,1.05)+
#xlim(-0.05,0.05)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_saber_stats %>%
ggplot(aes(x = wrc_plus_dif,
y = fip_minus_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>wRC+:',
wRC._winner,
'<br>','FIP-: ', FIP_winner,
'<br><br><b>',name_loser, '</b></br>wRC+:',
wRC._loser,
'<br>', 'FIP-: ',
FIP_loser,
'<br><br>', 'wRC+ Dif: ',
wrc_plus_dif,
'<br>', 'FIP- Dif: ',
fip_minus_dif
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('FIP- Dif')+
xlab('wRC+ Dif')+
ylim(-20,20)+
xlim(-25,25)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ggplotly(ws_saber_scatter, tooltip = "text") %>%
layout(legend=list(title=list(text='<b>Winner Type</b>')))
ws_saber_stats <- world_series_team_stats %>%
mutate(adv_type = case_when(fip_minus_dif >= 0 & wrc_plus_dif <= 0 ~ 'Better Pitching and Hitting',
fip_minus_dif < 0 & wrc_plus_dif <= 0 ~ 'Better Pitching, Worse Hitting',
fip_minus_dif < 0 & wrc_plus_dif > 0 ~ 'Worse Pitching and Hitting',
fip_minus_dif >= 0 & wrc_plus_dif > 0 ~ 'Worse Pitching, Better Hitting'))
ws_saber_table <- ws_saber_stats %>%
group_by(better_wrc_plus, better_fip_minus) %>%
summarise(teams = n()) %>%
pivot_wider(names_from = better_fip_minus, values_from = teams) %>%
ungroup() %>%
mutate(Total = `Better FIP-` + `Worse FIP-`) %>%
gt() %>%
grand_summary_rows(columns = c(2:4),
formatter = fmt_integer,
fns = list(Total = ~sum(.))) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
better_wrc_plus = "",
)
ws_saber_scatter <- ws_saber_stats %>%
ggplot(aes(x = wrc_plus_dif,
y = fip_minus_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>wRC+:',
wRC._winner,
'<br>','FIP-: ', FIP_winner,
'<br><br><b>',name_loser, '</b></br>wRC+:',
wRC._loser,
'<br>', 'FIP-: ',
FIP_loser,
'<br><br>', 'wRC+ Dif: ',
wrc_plus_dif,
'<br>', 'FIP- Dif: ',
fip_minus_dif
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('FIP- Dif')+
xlab('wRC+ Dif')+
ylim(-20,20)+
xlim(-25,25)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_saber_table
ggplotly(ws_saber_scatter, tooltip = "text") %>%
layout(legend=list(title=list(text='<b>Winner Type</b>')))
ws_saber_stats <- world_series_team_stats %>%
mutate(adv_type = case_when(fip_minus_dif >= 0 & wrc_plus_dif <= 0 ~ 'Better Pitching and Hitting',
fip_minus_dif < 0 & wrc_plus_dif <= 0 ~ 'Better Pitching, Worse Hitting',
fip_minus_dif < 0 & wrc_plus_dif > 0 ~ 'Worse Pitching and Hitting',
fip_minus_dif >= 0 & wrc_plus_dif > 0 ~ 'Worse Pitching, Better Hitting'))
ws_saber_table <- ws_saber_stats %>%
group_by(better_wrc_plus, better_fip_minus) %>%
summarise(teams = n()) %>%
pivot_wider(names_from = better_fip_minus, values_from = teams) %>%
ungroup() %>%
mutate(Total = `Better FIP-` + `Worse FIP-`) %>%
gt() %>%
grand_summary_rows(columns = c(2:4),
formatter = fmt_integer,
fns = list(Total = ~sum(.))) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
better_wrc_plus = "",
)
ws_saber_scatter <- ws_saber_stats %>%
ggplot(aes(x = wrc_plus_dif,
y = fip_minus_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>wRC+:',
wRC._winner,
'<br>','FIP-: ', FIP._winner,
'<br><br><b>',name_loser, '</b></br>wRC+:',
wRC._loser,
'<br>', 'FIP-: ',
FIP._loser,
'<br><br>', 'wRC+ Dif: ',
wrc_plus_dif,
'<br>', 'FIP- Dif: ',
fip_minus_dif
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('FIP- Dif')+
xlab('wRC+ Dif')+
ylim(-20,20)+
xlim(-25,25)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_saber_table
ggplotly(ws_saber_scatter, tooltip = "text") %>%
layout(legend=list(title=list(text='<b>Winner Type</b>')))
94-95
ws_saber_stats <- world_series_team_stats %>%
mutate(adv_type = case_when(fip_minus_dif <= 0 & wrc_plus_dif <= 0 ~ 'Better Pitching and Hitting',
fip_minus_dif > 0 & wrc_plus_dif <= 0 ~ 'Better Pitching, Worse Hitting',
fip_minus_dif > 0 & wrc_plus_dif > 0 ~ 'Worse Pitching and Hitting',
fip_minus_dif <= 0 & wrc_plus_dif > 0 ~ 'Worse Pitching, Better Hitting'))
ws_saber_table <- ws_saber_stats %>%
group_by(better_wrc_plus, better_fip_minus) %>%
summarise(teams = n()) %>%
pivot_wider(names_from = better_fip_minus, values_from = teams) %>%
ungroup() %>%
mutate(Total = `Better FIP-` + `Worse FIP-`) %>%
gt() %>%
grand_summary_rows(columns = c(2:4),
formatter = fmt_integer,
fns = list(Total = ~sum(.))) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
better_wrc_plus = "",
)
ws_saber_scatter <- ws_saber_stats %>%
ggplot(aes(x = wrc_plus_dif,
y = fip_minus_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>wRC+:',
wRC._winner,
'<br>','FIP-: ', FIP._winner,
'<br><br><b>',name_loser, '</b></br>wRC+:',
wRC._loser,
'<br>', 'FIP-: ',
FIP._loser,
'<br><br>', 'wRC+ Dif: ',
wrc_plus_dif,
'<br>', 'FIP- Dif: ',
fip_minus_dif
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('FIP- Dif')+
xlab('wRC+ Dif')+
ylim(-20,20)+
xlim(-25,25)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_saber_table
ggplotly(ws_saber_scatter, tooltip = "text") %>%
layout(legend=list(title=list(text='<b>Winner Type</b>')))
91-110
ws_ra_stats <- world_series_team_stats %>%
mutate(adv_type = case_when(RS_G_dif >= 0 & RA_G_dif <= 0 ~ 'Better Pitching and Hitting',
RS_G_dif > 0 & RA_G_dif <= 0 ~ 'Better Pitching, Worse Hitting',
RS_G_dif < 0 & RA_G_dif > 0 ~ 'Worse Pitching and Hitting',
RS_G_dif >= 0 & RA_G_dif > 0 ~ 'Worse Pitching, Better Hitting'))
ws_ra_scatter <- ws_ra_stats %>%
ggplot(aes(x = RS_G_dif,
y = RA_G_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>Runs Scored Per Game:',
round(RS_G_winner, 2),
'<br>','Runs Allowed Per Game: ', round(RA_G_winner, 2),
'<br><br><b>',name_loser, '</b></br>Runs Scored Per Game:',
round(RS_G_loser, 2),
'<br>', 'Runs Allowed Per Game: ',
round(RA_G_loser, 2),
'<br><br>', 'Runs Scored Per Game Dif: ',
round(RS_G_dif, 2),
'<br>', 'Runs Allowed Per Game Dif: ',
round(RA_G_dif, 2)
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('RA/G Dif')+
xlab('RS/G Dif')+
ylim(-1.5,1.5)+
xlim(-2.5,2.5)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_ra_trend <- ws_ra_stats %>%
ggplot(aes(x = yearID,
y = min(1),
fill = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>Runs Scored Per Game:',
round(RS_G_winner, 2),
'<br>','Runs Allowed Per Game: ', round(RA_G_winner, 2),
'<br><br><b>',name_loser, '</b></br>Runs Scored Per Game:',
round(RS_G_loser, 2),
'<br>', 'Runs Allowed Per Game: ',
round(RA_G_loser, 2),
'<br><br>', 'Runs Scored Per Game Dif: ',
round(RS_G_dif, 2),
'<br>', 'Runs Allowed Per Game Dif: ',
round(RA_G_dif, 2)
)))+
geom_bar(stat = 'identity')+ #, show.legend = FALSE
#scale_color_manual(values = c("#6A84D4", "#FF9F8D"))+
scale_fill_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme_ipsum()+
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
scale_x_continuous(breaks = seq(1920, 2020, by = 10))+
xlab('Season')
ws_ra_table <- ws_ra_stats %>%
group_by(better_RS_G_dif, better_RA_G_dif) %>%
summarise(teams = n()) %>%
pivot_wider(names_from = better_RA_G_dif, values_from = teams) %>%
ungroup() %>%
mutate(Total = `Better RA/G` + `Worse RA/G`) %>%
gt() %>%
grand_summary_rows(columns = c(2:4),
formatter = fmt_integer,
fns = list(Total = ~sum(.))) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
better_RS_G_dif = "",
)
ws_ra_table
ggplotly(ws_ra_scatter, tooltip = "text") %>%
layout(legend=list(title=list(text='<b>Winner Type</b>')))
ws_ra_stats <- world_series_team_stats %>%
mutate(adv_type = case_when(RS_G_dif >= 0 & RA_G_dif <= 0 ~ 'Better Pitching and Hitting',
RS_G_dif < 0 & RA_G_dif <= 0 ~ 'Better Pitching, Worse Hitting',
RS_G_dif < 0 & RA_G_dif > 0 ~ 'Worse Pitching and Hitting',
RS_G_dif >= 0 & RA_G_dif > 0 ~ 'Worse Pitching, Better Hitting'))
ws_ra_scatter <- ws_ra_stats %>%
ggplot(aes(x = RS_G_dif,
y = RA_G_dif,
color = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>Runs Scored Per Game:',
round(RS_G_winner, 2),
'<br>','Runs Allowed Per Game: ', round(RA_G_winner, 2),
'<br><br><b>',name_loser, '</b></br>Runs Scored Per Game:',
round(RS_G_loser, 2),
'<br>', 'Runs Allowed Per Game: ',
round(RA_G_loser, 2),
'<br><br>', 'Runs Scored Per Game Dif: ',
round(RS_G_dif, 2),
'<br>', 'Runs Allowed Per Game Dif: ',
round(RA_G_dif, 2)
)))+
geom_point(alpha = 0.8)+
theme_ipsum()+
ylab('RA/G Dif')+
xlab('RS/G Dif')+
ylim(-1.5,1.5)+
xlim(-2.5,2.5)+
scale_color_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme(legend.title = element_blank())
ws_ra_trend <- ws_ra_stats %>%
ggplot(aes(x = yearID,
y = min(1),
fill = adv_type,
text = paste0('<b>', yearID, ' ',name_winner, ' beat ',name_loser,'</b>',
'<br><b>',name_winner, '</b><br>Runs Scored Per Game:',
round(RS_G_winner, 2),
'<br>','Runs Allowed Per Game: ', round(RA_G_winner, 2),
'<br><br><b>',name_loser, '</b></br>Runs Scored Per Game:',
round(RS_G_loser, 2),
'<br>', 'Runs Allowed Per Game: ',
round(RA_G_loser, 2),
'<br><br>', 'Runs Scored Per Game Dif: ',
round(RS_G_dif, 2),
'<br>', 'Runs Allowed Per Game Dif: ',
round(RA_G_dif, 2)
)))+
geom_bar(stat = 'identity')+ #, show.legend = FALSE
#scale_color_manual(values = c("#6A84D4", "#FF9F8D"))+
scale_fill_manual(values = c('#84F5B1', '#8490F5', '#F584C8', '#F5E984'))+
theme_ipsum()+
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
scale_x_continuous(breaks = seq(1920, 2020, by = 10))+
xlab('Season')
ws_ra_table <- ws_ra_stats %>%
group_by(better_RS_G_dif, better_RA_G_dif) %>%
summarise(teams = n()) %>%
pivot_wider(names_from = better_RA_G_dif, values_from = teams) %>%
ungroup() %>%
mutate(Total = `Better RA/G` + `Worse RA/G`) %>%
gt() %>%
grand_summary_rows(columns = c(2:4),
formatter = fmt_integer,
fns = list(Total = ~sum(.))) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
better_RS_G_dif = "",
)
ws_ra_table
ggplotly(ws_ra_scatter, tooltip = "text") %>%
layout(legend=list(title=list(text='<b>Winner Type</b>')))
blogdown::build_site()
blogdown::check_site()
blogdown::build_site()
blogdown
blogdown::serve_site()
blogdown::stop_server()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site(timestamp( = as.Date('2021-11-22')))
blogdown::build_site(timestamp(as.Date('2021-11-22')))
##------ 2021-11-22 ------##
blogdown::build_site()
blogdown::serve_site()
br_data <- Lahman::Teams %>%
select(yearID, teamIDBR, G, W, R, RA, DivWin, WCWin, LgWin, WSWin, name) %>%
mutate(RS_G = R/G,
RA_G = RA/G)
fg_hitting <- read.csv('fangraphs_team_hitting.csv')
fg_pitching <- read.csv('fangraphs_team_pitching.csv')
fg_all <- fg_hitting %>%
inner_join(fg_pitching, by = c('ï..Season', 'Team')) %>%
as_tibble() %>%
rename(yearID = ï..Season, teamIDBR = Team) %>%
select(yearID, teamIDBR, AVG, OBP, SLG, wOBA, wRC., BsR, Off, Def, WAR.x,
K.9, BB.9, HR.9, BABIP.y, ERA, FIP, WAR.y, ERA., FIP.) %>%
rename(batting_WAR = WAR.x, pitching_WAR = WAR.y, pitching_BABIP = BABIP.y) %>%
filter(yearID != 2021)
team_season_data <- fg_all %>%
left_join(br_data) %>%
filter(yearID >= 1920) %>%
mutate(decade_year = yearID%%10,
decade = yearID - yearID%%10)
world_series_winner <- team_season_data %>%
filter(LgWin == 'Y' & WSWin == 'Y')
world_series_loser <- team_season_data %>%
filter(LgWin == 'Y' & WSWin == 'N')
world_series_team_stats <- world_series_winner %>%
inner_join(world_series_loser, by = 'yearID', suffix = c('_winner', '_loser')) %>%
mutate(wrc_plus_dif = wRC._winner - wRC._loser,
fip_minus_dif = FIP._winner - FIP._loser,
era_dif = ERA_winner - ERA_loser,
avg_dif = AVG_winner - AVG_loser,
batting_WAR_dif = batting_WAR_winner - batting_WAR_loser,
pitching_WAR_dif = pitching_WAR_winner - pitching_WAR_loser,
RS_G_dif = RS_G_winner - RS_G_loser,
RA_G_dif = RA_G_winner - RA_G_loser) %>%
mutate(better_wrc_plus = case_when (wrc_plus_dif >= 0 ~ 'Better WRC+', TRUE ~ 'Worse WRC+'),
better_fip_minus = case_when (fip_minus_dif <= 0 ~ 'Better FIP-', TRUE ~ 'Worse FIP-'),
better_era = case_when (era_dif <=0 ~ 'Better ERA', TRUE ~ 'Worse ERA'),
better_avg = case_when (avg_dif >0 ~ 'Better AVG', TRUE ~ 'Worse AVG'),
better_batting_WAR_dif = case_when (batting_WAR_dif >= 0 ~ 'Better Batting WAR', TRUE ~ 'Worse Batting WAR'),
better_pitching_WAR_dif = case_when (pitching_WAR_dif >= 0 ~ 'Worse Pitching WAR', TRUE ~ 'Worse Pitching WAR'),
better_RS_G_dif = case_when (RS_G_dif >= 0 ~ 'Better RS/G', TRUE ~ 'Worse RS/G'),
better_RA_G_dif = case_when (RA_G_dif <= 0 ~ 'Better RA/G', TRUE ~ 'Worse RA/G')
)
blogdown::stop_server()
blogdown::build_site()
