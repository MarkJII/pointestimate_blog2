tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
set.seed(2021)
sample_size <- 600
sample_rate <- .6
sim_seq <- tibble(rep = 1:100) %>%
mutate(simdata = map(rep, ~rbinom(sample_size, 1, sample_rate))) %>%
unnest() %>%
group_by(rep) %>%
mutate(running_mean = cummean(simdata),
n = row_number(),
running_se = (running_mean * (1 - running_mean) / n) ^ .5,
running_low = running_mean - (running_se),
running_high = running_mean + (running_se)) %>%
ungroup() %>%
group_by(n) %>%
mutate(mean_sim = mean(running_mean))
sim_one <- sim_seq %>%
filter(rep == 28 & n%%10 == 0 & n <= 100)
sim_one %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sample_size <- 600
sample_rate <- .6
sim_seq <- tibble(rep = 1:100) %>%
mutate(simdata = map(rep, ~rbinom(sample_size, 1, sample_rate))) %>%
unnest() %>%
group_by(rep) %>%
mutate(running_mean = cummean(simdata),
n = row_number(),
running_se = (running_mean * (1 - running_mean) / n) ^ .5,
running_low = running_mean - (running_se),
running_high = running_mean + (running_se)) %>%
ungroup() %>%
group_by(n) %>%
mutate(mean_sim = mean(running_mean))
sim_one <- sim_seq %>%
filter(rep == 1 & n%%10 == 0 & n <= 100)
sim_one %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sample_size <- 600
sample_rate <- .6
sim_seq <- tibble(rep = 1:100) %>%
mutate(simdata = map(rep, ~rbinom(sample_size, 1, sample_rate))) %>%
unnest() %>%
group_by(rep) %>%
mutate(running_mean = cummean(simdata),
n = row_number(),
running_se = (running_mean * (1 - running_mean) / n) ^ .5,
running_low = running_mean - (running_se),
running_high = running_mean + (running_se)) %>%
ungroup() %>%
group_by(n) %>%
mutate(mean_sim = mean(running_mean))
sim_one <- sim_seq %>%
filter(rep == 2 & n%%10 == 0 & n <= 100)
sim_one %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 5 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 1 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 2 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 3 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 4 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 25 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 26 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_seq %>%
filter(rep == 26 & n%%10 == 0 & n <= 100)
sim_seq %>%
filter(n -= 100)
sim_seq %>%
filter(n == 100)
sim_two <- sim_seq %>%
filter(rep == 8 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
sim_two <- sim_seq %>%
filter(rep == 2 & n%%10 == 0 & n <= 100)
sim_two %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
mean_sim
ggplot(sim_seq, aes(x = n, y = running_mean, group = rep))+
geom_line(alpha = 0.3, size = 0.2, color = '#bcc0cc')+
geom_line(aes(x = n, y = mean_sim), color = '#6a84d4')+
theme_ipsum()
sim_seq %>%
filter(n <= 100) %>%
ggplot(aes(x = n, y = running_mean, group = rep))+
geom_line(alpha = 0.3, size = 0.2, color = '#bcc0cc')+
geom_line(aes(x = n, y = mean_sim), color = '#6a84d4')+
theme_ipsum()
im_seq %>%
filter(n <= 100) %>%
ggplot(aes(x = n, y = running_mean, group = rep))+
geom_line(alpha = 0.3, size = 0.2, color = '#bcc0cc')+
geom_line(aes(x = n, y = mean_sim), color = '#6a84d4')+
theme_ipsum()
sim_seq %>%
filter(n <= 100) %>%
ggplot(aes(x = n, y = running_mean, group = rep))+
geom_line(alpha = 0.3, size = 0.2, color = '#bcc0cc')+
geom_line(aes(x = n, y = mean_sim), color = '#6a84d4')+
theme_ipsum()
sim_seq %>%
filter(n <= 100) %>%
ggplot(aes(x = n, y = running_mean, group = rep))+
geom_line(alpha = 0.3, size = 0.2, color = '#bcc0cc')+
geom_line(aes(x = n, y = mean_sim), color = '#6a84d4')+
theme_ipsum()
sample_size <- 600
sample_rate <- .6
sim_seq <- tibble(rep = 1:1000) %>%
mutate(simdata = map(rep, ~rbinom(sample_size, 1, sample_rate))) %>%
unnest() %>%
group_by(rep) %>%
mutate(running_mean = cummean(simdata),
n = row_number(),
running_se = (running_mean * (1 - running_mean) / n) ^ .5,
running_low = running_mean - (running_se),
running_high = running_mean + (running_se)) %>%
ungroup() %>%
group_by(n) %>%
mutate(mean_sim = mean(running_mean))
sim_one <- sim_seq %>%
filter(rep == 8 & n%%10 == 0 & n <= 100)
sim_one %>%
ungroup() %>%
select(n, running_mean, running_se, running_low, running_high) %>%
gt() %>%
fmt_percent(
columns = c(running_mean, running_se, running_low, running_high),
decimals = 1
) %>%
tab_options(
column_labels.border.top.color = "white",
column_labels.border.top.width = px(3),
column_labels.border.bottom.color = "black",
table_body.hlines.color = "white",
table.border.bottom.color = "white",
table.border.bottom.width = px(3)
) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style = list(
cell_text(weight = "bold")
)
) %>%
cols_label(
n = "Games",
running_mean = "Win Percentage",
running_se = "Standard Error",
running_low = "Lower Range",
running_high = "Higher Range"
)
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
